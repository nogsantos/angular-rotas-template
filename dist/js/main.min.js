var app=angular.module("app",["ui.router","ngMaterial","ngAnimate","ngStorage","angular-loading-bar","ngFlash","ui.bootstrap"]);app.constant("config",{appName:"SisClient",appVersion:"0.0.1",apiUrl:"http://localhost:3000/v1"}),function(){"user strict";app.config(["$stateProvider","$urlRouterProvider","$httpProvider",function($stateProvider,$urlRouterProvider,$httpProvider){$urlRouterProvider.otherwise("/erro"),$stateProvider.state("login",{url:"/",templateUrl:"login.html",controller:"loginController",controllerAs:"ctrl",data:{requireLogin:!1}}).state("dashboard",{url:"/home",templateUrl:"dashboard.html",controller:"dashboardController",controllerAs:"ctrl",data:{requireLogin:!0}}).state("sobre",{url:"/sobre",templateUrl:"about.html",controller:"aboutController",controllerAs:"ctrl",data:{requireLogin:!0}}).state("usuarios",{url:"/usuarios",templateUrl:"users.html",controller:"userController",controllerAs:"ctrl",data:{requireLogin:!0}}).state("contato",{url:"/contato",templateUrl:"contact.html",controller:"contactController",controllerAs:"ctrl",data:{requireLogin:!0}}).state("erro",{url:"/erro",templateUrl:"error.html",controller:"erroController",controllerAs:"ctrl",data:{requireLogin:!0}})}])}(),function(){"user strict";app.controller("aboutController",["$scope","$http","$location","Flash","config","$uibModal","$mdDialog","$rootScope",function($scope,$http,$location,Flash,config,$uibModal,$mdDialog,$rootScope){function queryData(){$http.get(config.apiUrl+"/tweets").success(function(data){$scope.q=data.data}).error(function(error,status){var message="<strong>"+status+"- Erro</strong>"+error.meta.error.message;Flash.create("warning",message)})}var init=function(){$scope.title="Tweets",queryData()};$scope.form=function(title,id){$uibModal.open({animation:!0,templateUrl:"about.form.html",controller:"aboutFormController",size:"lg",backdrop:"static",resolve:{title:function(){return title},id:function(){return id}}})},$scope["delete"]=function(event,id){var confirm=$mdDialog.confirm().title("Confirma a exclusão do item selecionado?").targetEvent(event).ok("Confirmar").cancel("Cancelar");$mdDialog.show(confirm).then(function(){$http["delete"](config.apiUrl+"/tweets/"+id).success(function(ret){queryData(),message="<strong>Sucesso</strong> Item excluido com sucesso.",id=Flash.create("success",message)}).error(function(err){message="<strong>"+err.data.meta.error.message+"</strong> "+err.data.meta.error.details.body[0],id=Flash.create("success",message)})})},$rootScope.$on("reload",function(){queryData()}),init()}])}(),function(){"user strict";app.controller("aboutFormController",["$scope","$http","$uibModalInstance","config","$rootScope",function($scope,$http,$uibModalInstance,config,$rootScope){var id=$scope.$resolve.id;$scope.title="Tweetes - "+$scope.$resolve.title+" "+(null!==id?id:"");var pMethod="POST";null!==id&&($http.get(config.apiUrl+"/tweets/"+id).success(function(ret){$scope.body=ret.data[0].body,$scope.created_date=ret.data[0].created_at,$scope.updated_date=ret.data[0].updated_at}).error(function(err){console.log("erro"+err)}),pMethod="PUT"),$scope.save=function(){$http({method:pMethod,url:config.apiUrl+"/tweets"+(null!==id?"/"+id:""),data:{body:$scope.body}}).then(function(){$scope.alert="",$scope.alerts=[{type:"success",msg:"Cadastrado com sucesso!"}],$rootScope.$emit("reload")},function(response){$scope.alerts=[{type:"danger",msg:response.data.meta.error.message+": "+response.data.meta.error.details.body[0]}]})},$scope.closeAlert=function(index){$scope.alerts.splice(index,1)},$scope.cancel=function(){$uibModalInstance.dismiss("cancel")}}])}(),function(){"user strict";app.controller("contactController",["$scope",function($scope){$scope.title="Contato";var min=3;$scope.caracter_count=min,$scope.customers=[{name:"Dave Jones",city:"Phoenix"},{name:"Jame Riley",city:"Atlanta"},{name:"Heedy Walling",city:"Chandler"},{name:"Thomas Winter",city:"Seatle"},{name:"John Snool",city:"Black Walls"},{name:"Havel",city:"Dragon City"},{name:"Lucatiel",city:"Mirrah"}],$scope.addCustomer=function(){var customer={name:$scope.nome,city:$scope.cidade};$scope.customers.push(customer)},$scope.validLength=function(){return $scope.cidade.length<min|!1}}])}(),function(){"user strict";app.controller("dashboardController",["$scope","$mdDialog",function($scope,$mdDialog){$scope.title="Dashboard"}])}(),function(){"user strict";app.controller("erroController",["$scope",function($scope){$scope.pagina="Erro"}])}(),function(){"user strict";app.controller("loginController",["$scope","$localStorage","$sessionStorage","LoginFactory","Flash",function($scope,$localStorage,$sessionStorage,LoginFactory,Flash){function sucesso(res){$localStorage.lu={access_token:res.data[0].access_token,token_type:res.data[0].token_type},$sessionStorage.su={access_token:res.data[0].access_token,token_type:res.data[0].token_type},window.location="#/home"}$scope.init=function(){$scope.login={username:"um",password:"12345"}},$scope.logar=function(){var message,id,usuario=$scope.login.username.trim(),password=$scope.login.password.trim();""!==usuario&&""!==password?LoginFactory.doLogin($scope.login,function(res){res.type===!1?alert(res.data):sucesso(res)},function(res,status){var message="<strong>Erro: "+status+"</strong> Falha na tentativa de acesso ao sistema.";Flash.create("danger",message)}):(message="<strong>Atenção</strong> Campo(s) obrigatório(s) precisa(m) ser preenchido(s).",id=Flash.create("warning",message))},$scope.init()}]).factory("LoginFactory",["$http","config",function($http,config){return{doLogin:function(data,success,error){$http.post(config.apiUrl+"/access_tokens",data).success(success).error(error,status)}}}])}(),function(){"user strict";app.controller("mainController",["$scope","$http","$localStorage","$sessionStorage","config","$mdDialog",function($scope,$http,$localStorage,$sessionStorage,config,$mdDialog){var init=function(){$scope.title="Dashboard"};$scope.logout=function(ev){var confirm=$mdDialog.confirm().title("Deseja realmente sair do sistema com segurança?").targetEvent(ev).ok("Confirmar").cancel("Cancelar");$mdDialog.show(confirm).then(function(){$http["delete"](config.apiUrl+"/access_tokens/"+$localStorage.lu.access_token),$localStorage.$reset(),$sessionStorage.$reset(),window.location="/"})},init()}])}(),function(){"user strict";app.controller("userController",["$scope","$http","$location","Flash","config",function($scope,$http,$location,Flash,config){function consultarDados(){$http.get(config.apiUrl+"/users").success(function(data){$scope.q=data.data,$scope.meta=data.meta}).error(function(error,status){var message="<strong>"+status+"- Erro</strong>"+error.meta.error.message;Flash.create("warning",message)})}var init=function(){$scope.title="Usuários",consultarDados()};init()}])}(),function(){"user strict";app.config(["$mdThemingProvider","$localStorageProvider","$sessionStorageProvider","$httpProvider","cfpLoadingBarProvider",function($mdThemingProvider,$localStorageProvider,$sessionStorageProvider,$httpProvider,cfpLoadingBarProvider){var neonRedMap=$mdThemingProvider.extendPalette("blue",{500:"497799"});$mdThemingProvider.definePalette("neonBlue",neonRedMap),$mdThemingProvider.theme("default").primaryPalette("neonBlue"),$localStorageProvider.setKeyPrefix("_hsh."),$sessionStorageProvider.setKeyPrefix("_hsh."),$httpProvider.interceptors.push("httpRequestInterceptor"),cfpLoadingBarProvider.spinnerTemplate='<div id="loading-bar-container"><span class="fa fa-spinner fa-pulse fa-3x fa-fw"></div>'}]),app.run(["$rootScope","$http","$location","$localStorage","$sessionStorage","Flash","config",function($rootScope,$http,$location,$localStorage,$sessionStorage,Flash,config){function menuCheck(){$localStorage.lu&&$sessionStorage.su?($rootScope.menu=[{link:"dashboard",label:"Home",tooltip:"Pagina inicial",icone:"home"},{link:"sobre",label:"Sobre",tooltip:"Sobre o sistema",icone:"question-circle"},{link:"contato",label:"Contato",tooltip:"Contato",icone:"pencil"},{link:"usuarios",label:"Usuários",tooltip:"Usuários cadastrados no sistema",icone:"users"}],$rootScope.logoutButton=!0):($rootScope.menu=[],$rootScope.logoutButton=!1)}$rootScope.sysname=config.appName+" ["+config.appVersion+"]",$rootScope.$on("$stateChangeStart",function(event,toState){$rootScope.page=toState.name,Flash.clear();var requireLogin=toState.data.requireLogin;if(requireLogin&&(!$localStorage.lu||!$sessionStorage.su)){window.location="#/",event.preventDefault();var message="<strong>Atenção!</strong> Você precisa ser autenticado para acessar essa área no sistema.";Flash.create("warning",message)}menuCheck()})}])}(),function(){"user strict";app.factory("httpRequestInterceptor",["$localStorage",function($localStorage){return{request:function(config){return config.headers.Authorization="undefined"!=typeof $localStorage.lu?$localStorage.lu.access_token:'Basic realm="AppServer"',config.headers.Accept="application/json;odata=verbose",config}}}])}(),function(){"user strict"}();